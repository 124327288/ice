<icegrid>

  <application name="Test" import-default-templates="true">

    <replica-group id="Test">
      <object identity="nonallocatable" type="::Test"/>
      <object identity="nonallocatable2" type="::NotAllocatable"/>
    </replica-group>

    <node name="localnode">

      <server id="Glacier2" exe="${ice.dir}/bin/glacier2router">
         <adapter name="Glacier2.Client" id="" endpoints="default -p 12347 -h 127.0.0.1 -t 10000"/>
         <adapter name="Glacier2.Server" id="" endpoints="tcp -h 127.0.01"/>
         <adapter name="Glacier2.Admin" id="" endpoints="tcp -h 127.0.0.1" register-process="true"/>
         <property name="Glacier2.SessionManager" value="IceGrid/SessionManager"/>
         <property name="Glacier2.PermissionsVerifier" value="IceGrid/NullPermissionsVerifier"/>
         <property name="Glacier2.Client.Trace.Reject" value="2"/>
      </server>

      <server id="ObjectAllocation" exe="${test.dir}/server" activation="on-demand" pwd=".">
        <adapter name="Server" endpoints="default">
  	  <object identity="allocatable" type="::Test"/>
  	  <object identity="allocatablebis" type="::TestBis"/>
        </adapter>
      </server>


      <server id="ServerAllocation" exe="${test.dir}/server" activation="on-demand" pwd="." allocatable="true">
        <adapter name="Server" endpoints="default" id="ServerAlloc">
  	  <object identity="allocatable3" type="::TestServer1"/>
  	  <object identity="allocatable4" type="::TestServer2"/>

  	  <object identity="allocatable31" type="::TestMultipleByServer"/>
  	  <object identity="allocatable41" type="::TestMultipleByServer"/>
        </adapter>
      </server>

      <server id="ServerAllocation-1" exe="${test.dir}/server" activation="on-demand" pwd="." allocatable="true">
        <adapter name="Server" endpoints="default">
  	  <object identity="allocatable5" type="::TestMultipleServer"/>
        </adapter>
      </server>

      <server id="ServerAllocation-2" exe="${test.dir}/server" activation="on-demand" pwd="." allocatable="true">
        <adapter name="Server" endpoints="default">
  	  <object identity="allocatable6" type="::TestMultipleServer"/>
        </adapter>
      </server>
      
      <server id="ServerStress-1" exe="${test.dir}/server" activation="on-demand" pwd=".">
        <adapter name="Server" endpoints="default">
  	  <object identity="stress-1" type="::StressTest"/>
  	  <object identity="stress-2" type="::StressTest"/>
        </adapter>
      </server>

      <server id="ServerStress-2" exe="${test.dir}/server" activation="on-demand" pwd="." allocatable="true">
        <adapter name="Server" endpoints="default">
  	  <object identity="stress-3" type="::StressTest"/>
  	  <object identity="stress-4" type="::StressTest"/>
        </adapter>
      </server>

      <server id="ServerStress-3" exe="${test.dir}/server" activation="on-demand" pwd="." allocatable="true">
        <adapter name="Server" endpoints="default">
  	  <object identity="stress-5" type="::StressTest"/>
  	  <object identity="stress-6" type="::StressTest"/>
        </adapter>
      </server>

    </node>

  </application>

</icegrid>
