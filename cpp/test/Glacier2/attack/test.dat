# **********************************************************************
#
# Copyright (c) 2003-2006 ZeroC, Inc. All rights reserved.
#
# This copy of Ice is licensed to you under the terms described in the
# ICE_LICENSE file included in this distribution.
#
# **********************************************************************
#
# See RuleTester.cpp for code that reads and uses this file. This code
# is written to ruletester's stdin in run.py.
# 
# line format:
# init           - initialize or re-initialize the proxy verification object
#                  after changing some properties with nr, na, or nm.
# nr regexp      - new reject rule 
# na regexp      - new accept rule
# nm regexp      - new max endpoints rule 
# r proxy-string - test this proxy and expect a rejection
# a proxy-string - test this proxy and expect an accept
# EOF            - ends the process
#
init
a hello:tcp -h foo.there.com -p 10041
nr foo.there.com
init
r hello:tcp -h foo.there.com -p 10041
a hello:tcp -h some.there.com -p 10041
nr udp|foo.there.com
init
r hello:tcp -h foo.there.com -p 10041
a hello:tcp -h some.there.com -p 10041
r hello:udp -h some.there.com -p 10041
nr udp
na foo.there.com
init
r hello:udp -h some.there.com -p 10041
a hello:udp -h foo.there.com -p 10041
nr unset
na unset
init
a hello:udp -h foo.there.com -p 10041
nm 2
init
a hello:udp -h foo.there.com -p 10041
a hello:udp -h foo.there.com -p 10041:tcp -h foo.there.com -p 10042
r hello:udp -h foo.there.com -p 10041:tcp -h foo.there.com -p 10042:tcp -h some.there.com -p 10043
EOF
