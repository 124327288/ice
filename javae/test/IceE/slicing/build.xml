<!--
 **********************************************************************

 Copyright (c) 2003-2005 ZeroC, Inc. All rights reserved.

 This copy of Ice is licensed to you under the terms described in the
 ICE_LICENSE file included in this distribution.

 **********************************************************************
-->

<project name="test_Ice_slicing_objects" default="all" basedir=".">

    <!-- set global properties for this build -->
    <property name="top.dir" value="../../../.."/>

    <!-- Include common definitions -->
    <import file="${top.dir}/config/common.xml"/>

    <target name="init" depends="config-init"/>

    <property name="cclass.dir" value="cclasses"/>
    <property name="sclass.dir" value="sclasses"/>
    <property name="cgen.dir" value="cgenerated"/>
    <property name="sgen.dir" value="sgenerated"/>
    <property name="csrc.dir" value="csrc"/>
    <property name="ssrc.dir" value="ssrc"/>

    <target name="generate" depends="init">
        <!-- Create the output directory for generated code -->
        <mkdir dir="${cgen.dir}"/>
        <slice2javae outputdir="${cgen.dir}">
	    <includepath>
		<pathelement path="."/>
	    </includepath>
            <fileset dir="." includes="Test.ice"/>
        </slice2javae>
        <mkdir dir="${sgen.dir}"/>
        <slice2javae outputdir="${sgen.dir}">
	    <includepath>
		<pathelement path="."/>
	    </includepath>
            <fileset dir="." includes="Test.ice"/>
        </slice2javae>
        <mkdir dir="${sgen.dir}"/>
        <slice2javae outputdir="${sgen.dir}">
	    <includepath>
		<pathelement path="."/>
	    </includepath>
            <fileset dir="${ssrc.dir}" includes="ServerPrivate.ice"/>
        </slice2javae>
    </target>

    <target name="compile" depends="generate">
        <mkdir dir="${cclass.dir}"/>
        <javac srcdir="${cgen.dir}" destdir="${cclass.dir}" classpath="${lib.dir}" debug="${debug}"/>
        <javac srcdir="${csrc.dir}" destdir="${cclass.dir}"
            classpath="${lib.dir}" excludes="${cgen.dir}/**" debug="${debug}"/>
        <mkdir dir="${sclass.dir}"/>
        <javac srcdir="${sgen.dir}" destdir="${sclass.dir}" classpath="${lib.dir}" debug="${debug}"/>
        <javac srcdir="${ssrc.dir}" destdir="${sclass.dir}"
            classpath="${lib.dir}" excludes="${sgen.dir}/**" debug="${debug}"/>
    </target>

    <target name="all" depends="compile"/>

    <target name="clean">
        <delete dir="${cgen.dir}"/>
        <delete dir="${sgen.dir}"/>
        <delete dir="${cclass.dir}"/>
        <delete dir="${sclass.dir}"/>
    </target>

</project>
